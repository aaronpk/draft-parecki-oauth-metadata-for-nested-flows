<svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="794" height="1032"><desc>title%20Nested%20OAuth%20Flow%0A%0Aparticipant%20%22User%20Agent%22%20as%20UA%0Aparticipant%20%22Client%22%20as%20C%0Aparticipant%20%22Authorization%20Server%22%20as%20AS%0Aparticipant%20%22Identity%20Provider%22%20as%20IdP%0A%0A%0Agroup%20Outer%20OAuth%20Flow%20(Client%20to%20AS)%0AC-%3EUA%3A%201.%20Redirect%20to%20AS%0AUA-%3EAS%3A%202.%20Redirect%20to%20AS%0Agroup%20Inner%20OAuth%20flow%20(AS%20to%20IdP)%0AAS-%3EUA%3A%203.%20Redirect%20to%20IDP%0AUA-%3EIdP%3A%204.%20Redirect%20to%20IdP%0Anote%20over%20IdP%3A%205.%20User%20Login%0AIdP--%3EUA%3A%206.%20Authorization%20Code%0AUA-%3EAS%3A%207.%20Authorization%20Code%0AAS-%3EIdP%3A%208.%20Token%20Request%20with%5CnAuthorization%20Code%0AIdP--%3EAS%3A%209.%20Access%20Token%5Cn%20%20%20%20%2B%20ID%20Token%0Aend%0AUA%3C--AS%3A%2010.%20Authorization%20Code%0AUA-%3EC%3A%2011.%20Authorization%20Code%0AC-%3EAS%3A%2012.%20Token%20Request%20with%5CnAuthorization%20Code%0AC%3C--AS%3A%2013.%20Access%20Token%0Aend</desc><defs/><g><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g/><g><rect fill="white" stroke="none" x="0" y="0" width="794" height="1032"/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="16.5pt" font-style="normal" font-weight="normal" text-decoration="normal" x="301.8165198182324" y="26.3876361" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Nested OAuth Flow</text></g><g/><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 96.7546657 103.26361593799999 L 96.7546657 1032.108406658" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 291.7260926192057 103.26361593799999 L 291.7260926192057 1032.108406658" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 491.0282537913411 103.26361593799999 L 491.0282537913411 1032.108406658" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 682.1772319800781 103.26361593799999 L 682.1772319800781 1032.108406658" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="13.532121076923076,5.863919133333333"/></g><g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 40.9997622413125 55.94178853199999 L 152.5095691586875 55.94178853199999 L 152.5095691586875 103.26361593799999 L 40.9997622413125 103.26361593799999 L 40.9997622413125 55.94178853199999 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="60.086819020312504" y="85.67185853800001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">User Agent</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 253.89888538854555 55.94178853199999 L 329.5532998498659 55.94178853199999 L 329.5532998498659 103.26361593799999 L 253.89888538854555 103.26361593799999 L 253.89888538854555 55.94178853199999 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="272.98594216754555" y="85.67185853800001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Client</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 405.5310712799192 55.94178853199999 L 576.525436302763 55.94178853199999 L 576.525436302763 103.26361593799999 L 405.5310712799192 103.26361593799999 L 405.5310712799192 55.94178853199999 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="424.61812805891924" y="85.67185853800001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Authorization Server</text></g><path fill="none" stroke="none"/><g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 610.1267123714882 55.94178853199999 L 754.227751588668 55.94178853199999 L 754.227751588668 103.26361593799999 L 610.1267123714882 103.26361593799999 L 610.1267123714882 55.94178853199999 Z" stroke-miterlimit="10" stroke-width="2.814681184" stroke-dasharray=""/></g><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="629.2137691504882" y="85.67185853800001" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Identity Provider</text></g></g><g><g><g><rect fill="white" stroke="none" x="136.1936184182552" y="185.94487571799996" width="116.09352148269531" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="138.8323820282552" y="201.77745737799998" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">1. Redirect to AS</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 291.7260926192057 208.81416033799997 L 111.23854595933334 208.81416033799997" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(96.7546657,208.81416033799997) translate(-96.7546657,-208.81416033799997)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 111.41446353333333 201.4842614213333 L 96.7546657 208.81416033799997 L 111.41446353333333 216.14405925466664 Z"/></g></g><g><g><rect fill="white" stroke="none" x="235.84469900432288" y="235.20179643799995" width="116.09352148269531" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="238.4834626143229" y="251.03437809799996" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">2. Redirect to AS</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 96.7546657 258.07108105799995 L 476.5443735320078 258.07108105799995" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(491.0282537913411,258.07108105799995) translate(-491.0282537913411,-258.07108105799995)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 476.36845595800776 250.74118214133327 L 491.0282537913411 258.07108105799995 L 476.36845595800776 265.4009799746666 Z"/></g></g><g><g><rect fill="white" stroke="none" x="233.40375051799475" y="331.95646213799995" width="120.97541845535156" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="236.04251412799476" y="347.78904379799997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">3. Redirect to IDP</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 491.0282537913411 354.8257467579999 L 111.23854595933334 354.8257467579999" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(96.7546657,354.8257467579999) translate(-96.7546657,-354.8257467579999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 111.41446353333333 347.4958478413333 L 96.7546657 354.8257467579999 L 111.41446353333333 362.1556456746666 Z"/></g></g><g><g><rect fill="white" stroke="none" x="330.1951356694921" y="381.21338285799993" width="118.54162634109375" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="332.83389927949213" y="397.04596451799995" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">4. Redirect to IdP</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 96.7546657 404.0826674779999 L 667.6933517207448 404.0826674779999" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(682.1772319800781,404.0826674779999) translate(-682.1772319800781,-404.0826674779999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 667.5174341467448 396.75276856133326 L 682.1772319800781 404.0826674779999 L 667.5174341467448 411.41256639466656 Z"/></g></g><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 613.9517943861914 430.4703035779999 L 734.5700879139649 430.4703035779999 L 750.4026695739649 446.30288523799993 L 750.4026695739649 470.9313455979999 L 613.9517943861914 470.9313455979999 L 613.9517943861914 430.4703035779999 M 734.5700879139649 430.4703035779999 L 734.5700879139649 446.30288523799993 L 750.4026695739649 446.30288523799993" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="638.5802547461914" y="455.0987639379999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">5. User Login</text></g><g><g><rect fill="white" stroke="none" x="316.3332963750585" y="497.31898169799996" width="146.26530492996093" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="318.97205998505854" y="513.151563358" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">6. Authorization Code</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 682.1772319800781 520.1882663179999 L 111.23854595933334 520.1882663179999" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="7.0367029599999995"/><g transform="translate(96.7546657,520.1882663179999) translate(-96.7546657,-520.1882663179999)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 111.41446353333333 512.8583674013332 L 96.7546657 520.1882663179999 L 111.41446353333333 527.5181652346666 Z"/></g></g><g><g><rect fill="white" stroke="none" x="220.75880728069006" y="546.5759024179999" width="146.26530492996093" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="223.39757089069008" y="562.4084840779999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">7. Authorization Code</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 96.7546657 569.445187038 L 476.5443735320078 569.445187038" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(491.0282537913411,569.445187038) translate(-491.0282537913411,-569.445187038)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 476.36845595800776 562.1152881213333 L 491.0282537913411 569.445187038 L 476.36845595800776 576.7750859546667 Z"/></g></g><g><g><rect fill="white" stroke="none" x="511.84516671467446" y="595.832823138" width="149.5151523420703" height="22.86928462"/></g><g><rect fill="white" stroke="none" x="511.84516671467446" y="613.424580538" width="129.96609533523437" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="514.4839303246745" y="611.6654047979999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">8. Token Request with</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="514.4839303246745" y="629.257162198" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Authorization Code</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 491.0282537913411 636.293865158 L 667.6933517207448 636.293865158" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(682.1772319800781,636.293865158) translate(-682.1772319800781,-636.293865158)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 667.5174341467448 628.9639662413333 L 682.1772319800781 636.293865158 L 667.5174341467448 643.6237640746667 Z"/></g></g><g><g><rect fill="white" stroke="none" x="530.592488797194" y="662.6815012579999" width="112.02050817703125" height="22.86928462"/></g><g><rect fill="white" stroke="none" x="530.592488797194" y="680.2732586579999" width="92.05633581375" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="533.231252407194" y="678.5140829179999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">9. Access Token</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="533.231252407194" y="696.1058403179999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">    + ID Token</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 682.1772319800781 703.142543278 L 505.51213405067443 703.142543278" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="7.0367029599999995"/><g transform="translate(491.0282537913411,703.142543278) translate(-491.0282537913411,-703.142543278)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 505.6880516246745 695.8126443613332 L 491.0282537913411 703.142543278 L 505.6880516246745 710.4724421946667 Z"/></g></g><g><g><rect fill="white" stroke="none" x="216.68221578899085" y="755.917815478" width="154.41848791335937" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="219.32097939899086" y="771.7503971379999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">10. Authorization Code</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 491.0282537913411 778.787100098 L 111.23854595933334 778.787100098" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="7.0367029599999995"/><g transform="translate(96.7546657,778.787100098) translate(-96.7546657,-778.787100098)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 111.41446353333333 771.4572011813333 L 96.7546657 778.787100098 L 111.41446353333333 786.1169990146667 Z"/></g></g><g><g><rect fill="white" stroke="none" x="117.57157862333334" y="805.174736198" width="153.33760107253906" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="120.21034223333334" y="821.007317858" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">11. Authorization Code</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 96.7546657 828.044020818 L 277.2422123598724 828.044020818" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(291.7260926192057,828.044020818) translate(-291.7260926192057,-828.044020818)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 277.06629478587234 820.7141219013333 L 291.7260926192057 828.044020818 L 277.06629478587234 835.3739197346667 Z"/></g></g><g><g><rect fill="white" stroke="none" x="312.543005542539" y="854.4316569179999" width="157.66833532546875" height="22.86928462"/></g><g><rect fill="white" stroke="none" x="312.543005542539" y="872.0234143179999" width="129.96609533523437" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="315.181769152539" y="870.2642385779999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">12. Token Request with</text><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="315.181769152539" y="887.8559959779999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Authorization Code</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 291.7260926192057 894.892698938 L 476.5443735320078 894.892698938" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray=""/><g transform="translate(491.0282537913411,894.892698938) translate(-491.0282537913411,-894.892698938)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 476.36845595800776 887.5628000213333 L 491.0282537913411 894.892698938 L 476.36845595800776 902.2225978546667 Z"/></g></g><g><g><rect fill="white" stroke="none" x="331.2903276250585" y="921.280335038" width="120.17369116042968" height="22.86928462"/></g><text fill="black" stroke="none" font-family="sans-serif" font-size="11pt" font-style="normal" font-weight="normal" text-decoration="normal" x="333.92909123505854" y="937.1129166979999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">13. Access Token</text></g><g><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 491.0282537913411 944.149619658 L 306.209972878539 944.149619658" stroke-miterlimit="10" stroke-width="1.4659797833333332" stroke-dasharray="7.0367029599999995"/><g transform="translate(291.7260926192057,944.149619658) translate(-291.7260926192057,-944.149619658)"><path fill="black" stroke="none" paint-order="stroke fill markers" d=" M 306.38589045253906 936.8197207413333 L 291.7260926192057 944.149619658 L 306.38589045253906 951.4795185746667 Z"/></g></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 17.591757400000006 138.447130738 L 776.7903056739648 138.447130738 L 776.7903056739648 970.5372557579999 L 17.591757400000006 970.5372557579999 L 17.591757400000006 138.447130738 Z" stroke-miterlimit="10" stroke-width="2.5131082" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 17.591757400000006 138.447130738 L 17.591757400000006 159.55723961799998 L 230.66092283476564 159.55723961799998 L 241.21597727476563 149.002185178 L 241.21597727476563 138.447130738 L 17.591757400000006 138.447130738" stroke-miterlimit="10" stroke-width="2.5131082" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="35.183514800000005" y="152.52053665799997" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Outer OAuth Flow (Client to AS)</text></g><g><g/><path fill="none" stroke="black" paint-order="fill stroke markers" d=" M 35.18351480000001 284.45871715799996 L 759.1985482739648 284.45871715799996 L 759.1985482739648 729.530179378 L 35.18351480000001 729.530179378 L 35.18351480000001 284.45871715799996 Z" stroke-miterlimit="10" stroke-width="2.5131082" stroke-dasharray=""/><path fill="white" stroke="black" paint-order="fill stroke markers" d=" M 35.18351480000001 284.45871715799996 L 35.18351480000001 305.56882603799994 L 228.05167620644534 305.56882603799994 L 238.60673064644533 295.01377159799995 L 238.60673064644533 284.45871715799996 L 35.18351480000001 284.45871715799996" stroke-miterlimit="10" stroke-width="2.5131082" stroke-dasharray=""/><text fill="black" stroke="none" font-family="sans-serif" font-size="8.8pt" font-style="normal" font-weight="bold" text-decoration="normal" x="52.77527220000001" y="298.5321230779999" text-anchor="start" dominant-baseline="alphabetic" xml:space="preserve">Inner OAuth flow (AS to IdP)</text></g></g></g></svg>